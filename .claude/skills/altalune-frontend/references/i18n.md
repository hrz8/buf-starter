# Internationalization (i18n)

## Translation Files

**Location:** `frontend/i18n/locales/{locale}.json`

**Supported Locales:**
- `en-US.json` - English (US) - Primary
- `en-GB.json` - English (UK)
- `id-ID.json` - Bahasa Indonesia
- `ms-MY.json` - Bahasa Melayu (Malaysia)

## Key Format Rules

### Always Use Fully Nested Structure

```json
// CORRECT - Fully nested structure
{
  "common": {
    "btn": {
      "cancel": "Cancel",
      "create": "Create"
    }
  },
  "features": {
    "entity": {
      "page": {
        "title": "Entities",
        "description": "Manage your entities"
      }
    }
  }
}

// WRONG - Mixed nesting (flat keys inside nested)
{
  "features": {
    "entity": {
      "page.title": "Entities"  // DON'T DO THIS
    }
  }
}
```

## Feature Translation Pattern

```json
{
  "features": {
    "{domain}": {
      "page": {
        "title": "Page Title",
        "description": "Page description"
      },
      "columns": {
        "name": "Name",
        "email": "Email",
        "status": "Status"
      },
      "form": {
        "nameLabel": "Name *",
        "namePlaceholder": "Enter name",
        "nameDescription": "Help text"
      },
      "messages": {
        "createSuccess": "Created successfully",
        "createSuccessDesc": "{name} has been created.",
        "createError": "Failed to create"
      },
      "actions": {
        "create": "Create Entity",
        "edit": "Edit",
        "delete": "Delete"
      },
      "dialogs": {
        "delete": {
          "title": "Delete Entity",
          "description": "Are you sure you want to delete {name}?"
        }
      },
      "sheet": {
        "createTitle": "Create Entity",
        "createDescription": "Fill in the details below."
      }
    }
  }
}
```

## Basic Usage

```vue
<script setup lang="ts">
const { t } = useI18n()
</script>

<template>
  <h1>{{ t('features.entity.page.title') }}</h1>
  <Button>{{ t('common.btn.create') }}</Button>
</template>
```

## Variables in Translations

```json
{
  "messages": {
    "createSuccessDesc": "{name} has been added to the team."
  }
}
```

```typescript
toast.success(
  t('features.entity.messages.createSuccessDesc', { name: 'John Doe' })
)
// Output: "John Doe has been added to the team."
```

## Rich Text (Bold/Italic)

Use `i18n-t` component for styled text interpolation:

```json
{
  "dialogs": {
    "delete": {
      "description": "Are you sure you want to delete {name}? This cannot be undone."
    }
  }
}
```

```vue
<AlertDialogDescription>
  <i18n-t keypath="features.entity.dialogs.delete.description" tag="span">
    <template #name>
      <strong>{{ entity.name }}</strong>
    </template>
  </i18n-t>
</AlertDialogDescription>
```

**Never use v-html with translations** - Security risk (XSS).

## Special Character Escaping

Escape `@` symbol (conflicts with i18n syntax):

```json
{
  "form": {
    "emailPlaceholder": "john.doe{'@'}company.com"
  }
}
```

## Reactive Translations in Computed

For programmatic rendering (e.g., table columns), wrap in `computed()`:

```typescript
// WRONG - Not reactive
const columns = [
  columnHelper.accessor('name', {
    header: ({ column }) =>
      h(DataTableColumnHeader, {
        column,
        title: t('features.entity.columns.name'),  // Called once only
      }),
  }),
]

// CORRECT - Reactive
const columns = computed(() => [
  columnHelper.accessor('name', {
    header: ({ column }) =>
      h(DataTableColumnHeader, {
        column,
        title: t('features.entity.columns.name'),  // Re-evaluated on locale change
      }),
  }),
])
```

## Navigation Translations

For navigation items (flat keys allowed in nav section):

```json
{
  "nav": {
    "dashboard": "Dashboard",
    "settings": {
      "title": "Settings",
      "apiKeys": "API Keys",
      "profile": "Profile"
    },
    "iam": {
      "title": "Identity & Access",
      "users": "Users",
      "roles": "Roles"
    }
  }
}
```

## Error Codes

Translate backend error codes:

```json
{
  "errorCodes": {
    "60001": "Invalid input",
    "60201": "Entity not found",
    "69901": "Server Error"
  }
}
```

```typescript
const errorMessage = t(`errorCodes.${errorCode}`)
```

## i18n-t Component Reference

```vue
<!-- Basic -->
<i18n-t keypath="key" tag="span" />

<!-- With variable slot -->
<i18n-t keypath="greeting" tag="p">
  <template #name>
    <strong>{{ user.name }}</strong>
  </template>
</i18n-t>

<!-- With link slot -->
<i18n-t keypath="terms.accept" tag="p">
  <template #link>
    <NuxtLink to="/terms" class="underline">
      {{ t('terms.linkText') }}
    </NuxtLink>
  </template>
</i18n-t>

<!-- Multiple slots -->
<i18n-t keypath="pricing.offer" tag="div">
  <template #price>
    <span class="font-bold">{{ price }}</span>
  </template>
  <template #discount>
    <Badge>{{ discount }}</Badge>
  </template>
</i18n-t>
```

## Database Values - Don't Translate

Don't translate values from database (dynamic data):

```typescript
// WRONG - Don't translate database values
const roles = [{ value: 'engineer', label: t('roles.engineer') }]

// CORRECT - Use database values directly
const roles = [{ value: 'engineer', label: 'Engineer' }]
```

## Checklist for New Translations

- [ ] Translation exists in **ALL 4** locale files (en-US, en-GB, id-ID, ms-MY)
- [ ] Keys follow fully nested structure
- [ ] Keys organized alphabetically
- [ ] Variables use `{variable}` syntax
- [ ] Special characters escaped
- [ ] Rich text uses `i18n-t` component
- [ ] Reactive contexts use `computed()` wrapper
- [ ] Database values are NOT translated

## Adding New Locale

1. Create new file in `frontend/i18n/locales/{locale}.json`
2. Copy structure from `en-US.json` as base
3. Translate all values
4. Register locale in `frontend/nuxt.config.ts`:

```typescript
i18n: {
  locales: [
    // ... existing locales
    {
      code: 'new-LOCALE',
      name: 'Language Name',
      file: 'new-LOCALE.json',
      dir: 'ltr',  // or 'rtl' for right-to-left
    },
  ],
}
```
