# altalune configuration
# This file demonstrates all available configuration options
# CLI flags take precedence over these values

# Server configuration
server:
  host: "localhost"       # Server host (default: localhost)
  port: 3100              # Server port (default: 3100)
  logLevel: "info"        # Log level: debug, info, warn, error (default: info)
  httpLogging: false      # Enable HTTP request/response logging middleware (default: false)
  enableCORS: true        # Enable CORS headers (default: true)
  readTimeout: 15         # HTTP read timeout in seconds (default: 15)
  writeTimeout: 15        # HTTP write timeout in seconds (default: 15)
  idleTimeout: 60         # HTTP idle timeout in seconds (default: 60)
  cleanupTimeout: 10      # HTTP cleanup timeout in seconds (default: 10)

# Database configuration
database:
  url: "postgres://postgres:toor@localhost:5432/altalune?sslmode=disable"   # PostgreSQL connection string
  maxConnections: 25                                                        # Maximum database connections (default: 25)
  maxIdleTime: 300                                                          # Max idle time for connections in seconds (default: 300)
  connectTimeout: 10                                                        # Database connection timeout in seconds (default: 10)

# Authentication server configuration (serve-auth command)
auth:
  host: "localhost"                                 # Auth server host (default: localhost)
  port: 3300                                        # Auth server port (default: 3300)
  sessionSecret: "gg6nAhpdc2ZetU37yquW8zQFo9V02KzP" # Session encryption secret (min 32 chars)
  codeExpiry: 600                                   # Authorization code expiry in seconds (default: 10 minutes)
  accessTokenExpiry: 3600                           # Access token (JWT) expiry in seconds (default: 1 hour)
  refreshTokenExpiry: 2592000                       # Refresh token expiry in seconds (default: 30 days)

# Security configuration
security:
  allowedOrigins:   # CORS allowed origins (default: ["*"])
    - "*"
  iamEncryptionKey: "rsLNVZTD4n8fQyvu8g8gaOHni7CKo2zweuxg2fuA8RY="  # 32-byte AES-256-GCM encryption key (base64-encoded) / openssl rand -base64 32

  # JWT signing keys for OAuth access tokens
  jwtPrivateKeyPath: "keys/jwt-private.pem"       # RSA private key path (for signing JWTs)
  jwtPublicKeyPath: "keys/jwt-public.pem"         # RSA public key path (for JWKS endpoint)
  jwksKid: "f7f99988-0cee-471b-8cbf-0d2fd1dfa22d" # Key ID for JWKS endpoint (JSON Web Key Set)

# Database seeder configuration (runs after migrations)
seeder:
  # Superadmin user (created on first migration)
  # This user has full access to all projects and owner role
  superadmin:
    email: "admin@altalune.id"    # Superadmin email address

  # Default OAuth client for Altalune Dashboard
  defaultOAuthClient:
    name: "Altalune Dashboard"                        # OAuth client display name
    clientId: "e730207a-0fce-495d-bac3-6211963ac423"  # Fixed UUID for dashboard client
    clientSecret: "0cMw4XzRZcRI4YDEqoY9AYWui3y4eZTQ"  # Dashboard client secret (min 32 chars)
    redirectUris:                                     # Allowed callback URLs
      - "http://localhost:3000/auth/callback"
      - "https://dashboard.altalune.id/auth/callback"
    pkceRequired: true                                # Suggested: Must be true for public clients (SPA, mobile apps)

  # OAuth providers for user login (Google, GitHub, etc.)
  # Secrets are encrypted with iamEncryptionKey before storage
  oauthProviders:
    - provider: "google"
      clientId: "your-google-client-id.apps.googleusercontent.com"
      clientSecret: "your-google-client-secret"
      redirectUrl: "http://localhost:3300/auth/callback"
      scopes: "openid,profile,email"
      enabled: true

    - provider: "github"
      clientId: "your-github-client-id"
      clientSecret: "your-github-client-secret"
      redirectUrl: "http://localhost:3300/auth/callback"
      scopes: "read:user,user:email"
      enabled: true
